<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ce78f0f8eb9749ab81a79228299f028c</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="d4e748c8-9241-4fce-ab46-8e3a0596c367" class="cell markdown">
<p>Asadbek Shamsiev: as9vd, Syed Ali: saa4cjw</p>
<p>CS 4501: Introduction to Algorithmic Economics</p>
<p>Denis Nekipelov and Hongning Wang</p>
<p>Spring 2023</p>
</div>
<div id="8c62beb0-e0d9-45a6-8809-574f24180685" class="cell markdown"
data-tags="[]">
<h1 id="final-report-shannon-switching-game">Final Report: Shannon
Switching Game</h1>
</div>
<div id="92337514-fd09-49e9-ba91-cb9fd7506dd7" class="cell markdown">
<p>Hello. We chose the Shannon Switching Game because we are both a big
fan of graph theory. Our game only had a few rules:</p>
<ol>
<li>s is in top-left (0, 0), t is bottom-right (m - 1, n - 1).</li>
<li>Fix-type player wants is to secure a path from s to t; to do this,
the fix-type player secures an edge in the graph in each iteration.</li>
<li>Cut-type player wants to disconnect s and t; to do this, the
cut-type player deletes an unsecured edge in the graph.</li>
<li>Game ends when there is a secured path from s to t (fix) or there
are no paths between s and t (cut).</li>
</ol>
<p>We chose to implement our graphs as grid matrices, like the following
for a 3x3 matrix:</p>
<p><img
src="vertopal_f10b1d835bda4576b33958c51d31ce56/0f2c11ec883b90f1fa59bf02f990c275b5bc65ce.png"
alt="3x3 graph" /></p>
<p>We did this because we felt it was easy to be consistent across
simulations. In this final report, we've detailed a lot of our work, but
there's also fantastic work in the other 3 documents, including our
training loop, our (failed) implementation of an agent, and our various
testing methods. Thank you.</p>
</div>
<div id="6d6f9f42-beb1-47e0-901b-da2e84b387e4" class="cell markdown"
data-jp-MarkdownHeadingCollapsed="true" data-tags="[]">
<h2 id="node-and-graph-classes">Node and Graph Classes</h2>
</div>
<div id="a63d1d97-221c-41de-a12c-f4b3cfe859a5" class="cell markdown">
<p>Here are our Node and Graph classes. As you can see, the create_nodes
internal function structured the graph in a square matrix (assuming
num_rows == num_cols). The nodes are just simple pieces of memory with a
value from 1-49 (in our 7x7 graph) and a corresponding adjacency list.
The nodes were numbered in a "Z" order, e.g. from left-to-right, and
then zig-zag to the next row's leftest-most value when there were no
more columns, and then you continued again. Like this:</p>
<p><img
src="vertopal_f10b1d835bda4576b33958c51d31ce56/0f2c11ec883b90f1fa59bf02f990c275b5bc65ce.png"
alt="3x3 graph" /></p>
</div>
<div id="d3ab29e1-4e08-46e7-8b3e-129773a96187" class="cell code"
data-execution_count="1">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Node:</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, val):</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.val <span class="op">=</span> val <span class="co"># Value of node = its position (left, right, zigzag, continue).</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.adj_list <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a list of edges for Game</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Graph:</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_rows, num_cols):</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_rows <span class="op">=</span> num_rows</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.num_cols <span class="op">=</span> num_cols</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_int <span class="op">=</span> <span class="va">self</span>._create_nodes()</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.matrix <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> <span class="dv">13</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">13</span>)]</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.edges <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_rows): <span class="co"># Kinda like initialising a 2D matrix. From the nodes generated, add the edges to the set.</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_cols):</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                node <span class="op">=</span> <span class="va">self</span>.nodes_mat[row][col]</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                adj_list <span class="op">=</span> <span class="va">self</span>.mapper[node.val].adj_list</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                node <span class="op">=</span> <span class="va">self</span>.mapper[node.val]</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> other_node <span class="kw">in</span> adj_list:</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.edges.add((node, other_node))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.edges.add((other_node, node))</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> init_start_and_end(<span class="va">self</span>):</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.start <span class="op">=</span> <span class="dv">1</span> <span class="co"># top-left</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.end <span class="op">=</span> <span class="va">self</span>.num_rows <span class="op">*</span> <span class="va">self</span>.num_cols <span class="co"># bottom-right</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _create_nodes(<span class="va">self</span>):</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        nodes_int, i <span class="op">=</span> [], <span class="dv">1</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> [[Node((row, col)) <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_cols)] <span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_rows)] </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        mapper <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        int_mapper <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_rows):</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_cols):</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>                node <span class="op">=</span> Node(i) <span class="co"># Create the nodes, number 1 to (m * n).</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>                nodes_int.append(node)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                mapper[(row, col)] <span class="op">=</span> node</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>                int_mapper[i] <span class="op">=</span> node</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>                i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_rows):</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_cols):</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                node <span class="op">=</span> nodes[row][col] <span class="co"># this stuff below is where we initialise the neighbours.</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> row <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>                    node.adj_list.add(nodes[row <span class="op">-</span> <span class="dv">1</span>][col])  <span class="co"># Upper neighbour.</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>                    nodes[row <span class="op">-</span> <span class="dv">1</span>][col].adj_list.add(node)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                    current_mapping <span class="op">=</span> mapper[(row, col)]</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                    nbr_mapping <span class="op">=</span> mapper[(row <span class="op">-</span> <span class="dv">1</span>, col)]</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>                    current_mapping.adj_list.add(nbr_mapping)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>                    nbr_mapping.adj_list.add(current_mapping)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> row <span class="op">&lt;</span> <span class="va">self</span>.num_rows <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>                    node.adj_list.add(nodes[row <span class="op">+</span> <span class="dv">1</span>][col])  <span class="co"># Lower neighbour.</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>                    nodes[row <span class="op">+</span> <span class="dv">1</span>][col].adj_list.add(node)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>                    current_mapping <span class="op">=</span> mapper[(row, col)]</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                    nbr_mapping <span class="op">=</span> mapper[(row <span class="op">+</span> <span class="dv">1</span>, col)]</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>                    current_mapping.adj_list.add(nbr_mapping)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>                    nbr_mapping.adj_list.add(current_mapping)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> col <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>                    node.adj_list.add(nodes[row][col <span class="op">-</span> <span class="dv">1</span>])  <span class="co"># Left neighbour.</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>                    nodes[row][col <span class="op">-</span> <span class="dv">1</span>].adj_list.add(node)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>                    current_mapping <span class="op">=</span> mapper[(row, col)]</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>                    nbr_mapping <span class="op">=</span> mapper[(row, col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>                    current_mapping.adj_list.add(nbr_mapping)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>                    nbr_mapping.adj_list.add(current_mapping)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> col <span class="op">&lt;</span> <span class="va">self</span>.num_cols <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>                    node.adj_list.add(nodes[row][col <span class="op">+</span> <span class="dv">1</span>])  <span class="co"># Right neighbour.</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>                    nodes[row][col <span class="op">+</span> <span class="dv">1</span>].adj_list.add(node)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>                    current_mapping <span class="op">=</span> mapper[(row, col)]</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>                    nbr_mapping <span class="op">=</span> mapper[(row, col <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>                    current_mapping.adj_list.add(nbr_mapping)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>                    nbr_mapping.adj_list.add(current_mapping)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_mat <span class="op">=</span> nodes</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.mapper <span class="op">=</span> mapper</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.int_mapper <span class="op">=</span> int_mapper</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> nodes_int</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> print_graph(<span class="va">self</span>): <span class="co"># for debugging purposes</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>([node.val <span class="cf">for</span> row <span class="kw">in</span> <span class="va">self</span>.nodes_mat <span class="cf">for</span> node <span class="kw">in</span> row])</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>()</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>([node.val <span class="cf">for</span> node <span class="kw">in</span> <span class="va">self</span>.nodes_int])</span></code></pre></div>
</div>
<div id="24522870-03ff-4e96-b565-045deecf1b26" class="cell markdown"
data-jp-MarkdownHeadingCollapsed="true" data-tags="[]">
<h2 id="feedforward-neural-network">Feedforward Neural Network</h2>
</div>
<div id="8b25ccdd-85dc-4e71-b0f3-b89e7ef025d3" class="cell markdown">
<p>Here was the model we used. It was a simple Feedforward Neural
Network with 4 layers, and a couple of non-linear ReLU operations to get
a table of probabilities. We could've used a more advanced structure,
namely a Convolutional Neural Network, but that was beyond the scope of
our abilities at the time. Additionally, the number of layers and the
hidden_size parameter were not deliberately thought out. We went through
trial-and-error to find values that produced semi-decent results.</p>
</div>
<div id="a24df1bd-edd1-4dbb-a175-83bf6f9087ce" class="cell code"
data-execution_count="2">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn <span class="im">as</span> nn</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.optim <span class="im">as</span> optim</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the Feedforward Neural Network.</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ShannonModel(nn.Module):</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, input_size, hidden_size, output_size, edges, game):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.edges <span class="op">=</span> edges</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.game <span class="op">=</span> game</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc1 <span class="op">=</span> nn.Linear(input_size, hidden_size) </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc2 <span class="op">=</span> nn.Linear(hidden_size, hidden_size)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc3 <span class="op">=</span> nn.Linear(hidden_size, hidden_size)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fc4 <span class="op">=</span> nn.Linear(hidden_size, output_size)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.relu(<span class="va">self</span>.fc1(x))</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.relu(<span class="va">self</span>.fc2(x))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> torch.relu(<span class="va">self</span>.fc3(x))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="va">self</span>.fc4(x)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        sorted_x, indices <span class="op">=</span> torch.sort(x, descending <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        max_probability <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        chosen_edge <span class="op">=</span> <span class="va">None</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> index <span class="kw">in</span> indices:</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>            edge <span class="op">=</span> <span class="va">self</span>.edges[index.item()]</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            reverse_edge <span class="op">=</span> (edge[<span class="dv">1</span>], edge[<span class="dv">0</span>])</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> ((edge <span class="kw">not</span> <span class="kw">in</span> <span class="va">self</span>.game.removed_edges <span class="kw">and</span> edge <span class="kw">not</span> <span class="kw">in</span> <span class="va">self</span>.game.secured_edges) <span class="kw">and</span> </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>                (reverse_edge <span class="kw">not</span> <span class="kw">in</span> <span class="va">self</span>.game.removed_edges <span class="kw">and</span> reverse_edge <span class="kw">not</span> <span class="kw">in</span> <span class="va">self</span>.game.secured_edges)): </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>                max_probability <span class="op">=</span> x[index]</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>                chosen_edge <span class="op">=</span> edge</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x, max_probability, chosen_edge <span class="co"># Return the probabilities and the valid edge with the max probability.</span></span></code></pre></div>
</div>
<div id="235b1f10-1236-4bdf-a5d4-2aab481411fd" class="cell markdown"
data-tags="[]">
<h2 id="game">Game</h2>
</div>
<div id="944bdf1c-cecd-4b91-a35d-40052b77b212" class="cell markdown">
<p>Below is where the magic happens, the Shannon Switching Game
implementation. We made the CUT player go first, and we constantly
checked if the match ended after each move. For the CUT player, that
happened to be if there were no more edges to be selected, albeit
checking for paths from t to s would've been smarter and more efficient.
For the FIX player, we did a BFS from the s node to the t node to check
if there was a complete path.</p>
</div>
<div id="67dfff0f-76ce-4b38-8f84-5f625619e034" class="cell code"
data-execution_count="10">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GameAI:</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, graph):</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.graph <span class="op">=</span> graph</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.m <span class="op">=</span> <span class="va">self</span>.graph.num_rows</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n <span class="op">=</span> <span class="va">self</span>.graph.num_cols</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.node_mapping <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, (<span class="va">self</span>.m <span class="op">*</span> <span class="va">self</span>.n) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.node_mapping[i] <span class="op">=</span> <span class="va">self</span>.graph.nodes_int[i <span class="op">-</span> <span class="dv">1</span>] <span class="co"># e.g. 1 is in index 0, 2 is index 1, etc.</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.edges <span class="op">=</span> []</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, (<span class="va">self</span>.graph.num_rows <span class="op">*</span> <span class="va">self</span>.graph.num_cols) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            adj_list <span class="op">=</span> [node.val <span class="cf">for</span> node <span class="kw">in</span> <span class="va">self</span>.graph.int_mapper[i].adj_list]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> adj_node <span class="kw">in</span> adj_list:</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (adj_node, i) <span class="kw">in</span> <span class="va">self</span>.edges:</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.edges.append((i, adj_node))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.edges <span class="op">=</span> <span class="bu">sorted</span>(<span class="va">self</span>.edges)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.unsecured_count <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.m <span class="op">*</span> <span class="va">self</span>.n) <span class="op">-</span> <span class="va">self</span>.m <span class="op">-</span> <span class="va">self</span>.n <span class="co"># this is for the CUT player</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.secured_edges <span class="op">=</span> [] <span class="co"># fix  </span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.removed_edges <span class="op">=</span> [] <span class="co"># cut</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.remaining <span class="op">=</span> {(node1.val, node2.val) <span class="cf">for</span> node1, node2 <span class="kw">in</span> <span class="va">self</span>.graph.edges} </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.end <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.matrix <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> <span class="dv">13</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">13</span>)]</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.init_matrix()</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reset(<span class="va">self</span>): <span class="co"># Reset everything for the next training iteration.</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.unsecured_count <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> <span class="va">self</span>.m <span class="op">*</span> <span class="va">self</span>.n) <span class="op">-</span> <span class="va">self</span>.m <span class="op">-</span> <span class="va">self</span>.n </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.secured_edges <span class="op">=</span> []</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.removed_edges <span class="op">=</span> []</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.remaining <span class="op">=</span> {(node1.val, node2.val) <span class="cf">for</span> node1, node2 <span class="kw">in</span> <span class="va">self</span>.graph.edges} </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.end <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.matrix <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> <span class="dv">13</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">13</span>)]</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.init_matrix()</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> init_matrix(<span class="va">self</span>):</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.edge_mapping <span class="op">=</span> <span class="bu">dict</span>() <span class="co"># tuples of nodes (e.g. (1, 2))</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        counter <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="va">self</span>.matrix)):</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="va">self</span>.matrix[row])):</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> row <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> col <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>: <span class="co"># 1.</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.matrix[row][col] <span class="op">=</span> counter</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>                        counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="va">self</span>.matrix)):</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="va">self</span>.matrix[row])):</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> row <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> col <span class="op">%</span> <span class="dv">2</span> <span class="op">!=</span> <span class="dv">0</span>: <span class="co"># 2.</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># self.matrix[row][col] = &quot;-&quot; # edge</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.matrix[row][col] <span class="op">=</span> <span class="st">&quot;&quot;</span> <span class="co"># edge</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># look to the left and right</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>                        left <span class="op">=</span> <span class="va">self</span>.matrix[row][col <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>                        right <span class="op">=</span> <span class="va">self</span>.matrix[row][col <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.edge_mapping[(left, right)] <span class="op">=</span> (row, col)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> col <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>: <span class="co"># 3</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># self.matrix[row][col] = &quot;|&quot;</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.matrix[row][col] <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># look up and down</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>                        up <span class="op">=</span> <span class="va">self</span>.matrix[row <span class="op">-</span> <span class="dv">1</span>][col]</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>                        down <span class="op">=</span> <span class="va">self</span>.matrix[row <span class="op">+</span> <span class="dv">1</span>][col]</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.edge_mapping[(up, down)] <span class="op">=</span> (row, col)</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>                        <span class="va">self</span>.matrix[row][col] <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Random now mate.</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> choose_edge_to_fix(<span class="va">self</span>):</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>        edge_to_fix <span class="op">=</span> random.choice(<span class="bu">list</span>(<span class="va">self</span>.remaining))</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> edge_to_fix</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plays step-by-step. This is what we&#39;ll use for &quot;learning&quot;.</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> next_step_player(<span class="va">self</span>, chosen_edge, user_edge):</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.unsecured_count <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> <span class="kw">not</span> <span class="va">self</span>.end:</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.end:</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1. CUT player&#39;s turn: where the magic happens. (HE NOW GOES FIRST)</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.remaining) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># No more valid edges to choose.</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">&quot;You lost mate.&quot;</span>)</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.end <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.cut(chosen_edge)</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.update_board(chosen_edge, cut <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2. FIX/user player&#39;s turn.</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.end:</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.remaining) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># No more valid edges to choose.</span></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">&quot;You lost mate.&quot;</span>)</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.end <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>                    edge_to_fix <span class="op">=</span> user_edge</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.fix(edge_to_fix)</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.update_board(edge_to_fix, cut <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.print_board()</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.is_fix_path_complete():</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;You won!&quot;</span>)</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.end <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span>      </span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">len</span>(<span class="va">self</span>.remaining) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">&quot;You lost mate.&quot;</span>)</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.end <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;You lost mate.&quot;</span>)</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.end <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update_board(<span class="va">self</span>, edge, cut):</span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>        coordinates <span class="op">=</span> <span class="va">self</span>.edge_mapping[edge]</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>        row, col <span class="op">=</span> coordinates[<span class="dv">0</span>], coordinates[<span class="dv">1</span>]</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cut:</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.matrix[row][col] <span class="op">=</span> <span class="st">&quot;X&quot;</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: <span class="co"># if it&#39;s the user&#39;s turn</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if vertical</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> row <span class="op">%</span> <span class="dv">2</span> <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.matrix[row][col] <span class="op">=</span> <span class="st">&quot;|&quot;</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: <span class="co"># if horiz</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.matrix[row][col] <span class="op">=</span> <span class="st">&quot;-&quot;</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> is_fix_path_complete(<span class="va">self</span>): <span class="co"># This does BFS to check if there is a path from the start to the end.</span></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>        visited <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>        stack <span class="op">=</span> [<span class="dv">1</span>]</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> stack:</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> stack.pop()</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_node <span class="op">==</span> <span class="va">self</span>.m <span class="op">*</span> <span class="va">self</span>.n: <span class="co"># e.g. 4x4, 16 is the bottom-right.</span></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_node <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>                visited.add(current_node)</span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>                adj_list <span class="op">=</span> <span class="va">self</span>.node_mapping[current_node].adj_list</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> nbr <span class="kw">in</span> adj_list:</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>                    edge <span class="op">=</span> (current_node, nbr.val)</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>                    reverse_edge <span class="op">=</span> (nbr.val, current_node)</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> edge <span class="kw">in</span> <span class="va">self</span>.secured_edges <span class="kw">or</span> reverse_edge <span class="kw">in</span> <span class="va">self</span>.secured_edges:</span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> nbr.val <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a>                            stack.append(nbr.val)</span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. FIX player&#39;s function; secures unsecured edge in question (and its reverse).</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fix(<span class="va">self</span>, edge):</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>        <span class="co"># edge = ex: (1, 4)</span></span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> edge <span class="kw">in</span> <span class="va">self</span>.remaining:</span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.remaining.remove(edge)</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.secured_edges.append(edge)</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.unsecured_count <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Also remove the reverse direction of the edge.</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>        reverse_edge <span class="op">=</span> (edge[<span class="dv">1</span>], edge[<span class="dv">0</span>])</span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> reverse_edge <span class="kw">in</span> <span class="va">self</span>.remaining:</span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.remaining.remove(reverse_edge)</span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. CUT player&#39;s function; removes unsecured edge in question (and its reverse).</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> cut(<span class="va">self</span>, edge):</span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>        <span class="co"># edge = ex: (1, 4)</span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> edge <span class="kw">in</span> <span class="va">self</span>.remaining:</span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.remaining.remove(edge)</span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.removed_edges.append(edge)</span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.unsecured_count <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Also remove the reverse direction of the edge.</span></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>        reverse_edge <span class="op">=</span> (edge[<span class="dv">1</span>], edge[<span class="dv">0</span>])</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> reverse_edge <span class="kw">in</span> <span class="va">self</span>.remaining:</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.remaining.remove(reverse_edge)</span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reward function</span></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_reward(<span class="va">self</span>):</span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.cut_win:</span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Positive reward when the CUT player wins</span></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a>            reward <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="va">self</span>.end:</span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Negative reward when the CUT player loses</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>            reward <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Intermediate &quot;reward&quot; for the ongoing game</span></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a>            reward <span class="op">=</span> <span class="fl">0.1</span>            </span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> reward</span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_state(<span class="va">self</span>):</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Define the state representation based on the game state.</span></span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>        secured_count <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.secured_edges)</span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>        remaining_count <span class="op">=</span> <span class="va">self</span>.unsecured_count</span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>        secured_edges <span class="op">=</span> <span class="va">self</span>.secured_edges</span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>        deleted_edges <span class="op">=</span> <span class="va">self</span>.removed_edges</span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>        remaining_edges <span class="op">=</span> <span class="bu">list</span>(<span class="va">self</span>.remaining) <span class="co"># Yet for this, we&#39;ll keep the reverse edges. Bit hypocritical, but screw it.</span></span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>        state <span class="op">=</span> (secured_edges, deleted_edges, remaining_edges, secured_count, remaining_count)</span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> state</span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> print_board(<span class="va">self</span>):</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>        max_width <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(<span class="bu">str</span>(element)) <span class="cf">for</span> row <span class="kw">in</span> <span class="va">self</span>.matrix <span class="cf">for</span> element <span class="kw">in</span> row)</span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> row <span class="kw">in</span> <span class="va">self</span>.matrix:</span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> element <span class="kw">in</span> row:</span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>element<span class="sc">:</span><span class="op">&gt;</span>{max_width}<span class="sc">}</span><span class="ss">&quot;</span>, end<span class="op">=</span><span class="st">&quot; &quot;</span>)</span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>()</span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is still here purely for debugging purposes.</span></span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> play(<span class="va">self</span>):</span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">self</span>.unsecured_count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 1. CUT player&#39;s turn</span></span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.remaining) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>                <span class="co"># No more valid edges to choose.</span></span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.end <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>            edge_to_cut <span class="op">=</span> <span class="va">self</span>.choose_edge_to_cut()</span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.cut(edge_to_cut)</span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 2. FIX player&#39;s turn</span></span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(<span class="va">self</span>.remaining) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a>                <span class="co"># No more valid edges to choose.</span></span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.end <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-240"><a href="#cb3-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-241"><a href="#cb3-241" aria-hidden="true" tabindex="-1"></a>            edge_to_fix <span class="op">=</span> <span class="va">self</span>.choose_edge_to_fix()</span>
<span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.fix(edge_to_fix)</span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.is_fix_path_complete():</span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">False</span></span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.end <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="va">self</span>.unsecured_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.cut_win <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.end <span class="op">=</span> <span class="va">True</span></span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This is still here purely for debugging purposes.</span></span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> choose_edge_to_cut(<span class="va">self</span>):</span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a>        edge_to_cut <span class="op">=</span> random.choice(<span class="bu">list</span>(<span class="va">self</span>.remaining))</span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> edge_to_cut</span></code></pre></div>
</div>
<div id="5ffff4ae-77ce-42d1-8613-1e39ef5f9d12" class="cell markdown"
data-jp-MarkdownHeadingCollapsed="true" data-tags="[]">
<h2 id="training">Training</h2>
</div>
<div id="c9fc6dc5-a596-478f-847a-d08b10b7b887" class="cell markdown">
<p>We used Reinforcement Learning to train our Cut and Fix models. For
the cut model, we had a reward of 0.1 if the game was continuing, 1.0 if
it won the game, and -1.0 if it lost. We chose the intermediate reward
of 0.1, because intuitively, if the cut player can prolong the game, he
is closer to winning. The states were represented as a large, integer
tensor of (secured_edges, deleted_edges, remaining_edges, secured_count,
remaining_count). The first 3 states were flattened adjacency matrices,
and the last 2 were simply integers. As for the Fix model, we did the
same exact thing, but the intermediate reward was 0.1, because we felt
the fix player needed to get a move on and secure the win as soon as
possible, before the cut player removed all the good edges. We trained
it using Mean-Standard Error for the loss-function, and Adam's Algorithm
for optimisation.</p>
</div>
<div id="9d1fb726-0f16-41e6-a330-003a5a9dba84" class="cell raw">

</div>
<div id="cb979bcc-3031-4fbf-870a-be29550da71d" class="cell markdown">
<p>Then, for training, we used the Bellman Equation/a Q-learning
algorithm to update the parameters of the neural network and maximise
the probabilities of the best possible edges. We updated the parameters
of the model constantly and let PyTorch compute the loss gradient for
us.</p>
</div>
<div id="08b233c8-4387-4771-9a50-385d147fb64b" class="cell raw">

</div>
<div id="2c5ab397-ab14-4a2a-8f60-20f33bce5225" class="cell markdown">
<p>More information is available on the 3_CutAI.ipynb notebook, where
the full code is present.</p>
</div>
<div id="b7a97e4d-de49-4f50-9ecb-79c0555e2c8f" class="cell markdown">
<h2 id="putting-the-ai-to-use">Putting the AI to Use</h2>
</div>
<div id="0b917e27-1cf6-4ec6-8596-7cb19b8b0dbb" class="cell markdown">
<p>We trained the AI on 2048 epochs for both the Cut and Fix players on
a 7x7 graph. For the Cut AI, we won nearly 300 more matches across 5000
simulations (seen in 3_CutAI.ipynb), whilst for the Fix AI, we won
nearly 1500 more matches across 10000 simulations (seen in
2_CleanUp.ipynb). Clearly significant improvements occurred in both of
these. But unfortunately, if you play against the "hyper efficient" Cut
AI (who only lost 0.6% of its matches against a random selector), it
proved to be quite daft. Here is an example below:</p>
</div>
<div id="030e87e4-ceb1-4cc2-8305-e79c7510c5b8" class="cell code"
data-execution_count="11">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>num_rows <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>num_cols <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> Graph(num_rows, num_cols)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>game <span class="op">=</span> GameAI(graph)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>edges <span class="op">=</span> game.edges</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>cut_ai <span class="op">=</span> ShannonModel(input_size <span class="op">=</span> <span class="dv">7502</span>, hidden_size <span class="op">=</span> <span class="dv">256</span>, output_size <span class="op">=</span> <span class="dv">84</span>, edges <span class="op">=</span> edges, game <span class="op">=</span> game)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>cut_ai.load_state_dict(torch.load(<span class="st">&quot;Cut/7x7Model.pt&quot;</span>))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>cut_ai.<span class="bu">eval</span>()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> deque</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader, TensorDataset</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.optim.lr_scheduler <span class="im">import</span> StepLR</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_state(state):</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    num_nodes <span class="op">=</span> find_max_number([state[<span class="dv">0</span>], state[<span class="dv">1</span>], state[<span class="dv">2</span>]])</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    secured_edges <span class="op">=</span> convert_to_adj_matrix(state[<span class="dv">0</span>], num_nodes)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    deleted_edges <span class="op">=</span> convert_to_adj_matrix(state[<span class="dv">1</span>], num_nodes)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    remaining_edges <span class="op">=</span> convert_to_adj_matrix(state[<span class="dv">2</span>], num_nodes)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    secured_count, remaining_count <span class="op">=</span> state[<span class="dv">3</span>], state[<span class="dv">4</span>]</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    secured_edges, deleted_edges, remaining_edges, secured_count, remaining_count <span class="op">=</span> (torch.tensor(secured_edges).flatten(), </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                                                                                     torch.tensor(deleted_edges).flatten(), </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                                                                                     torch.tensor(remaining_edges).flatten(), </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                                                                                     torch.tensor([secured_count]), </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>                                                                                     torch.tensor([remaining_count]))</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    formatted_state <span class="op">=</span> np.concatenate([secured_edges, deleted_edges, remaining_edges, secured_count, remaining_count]).tolist()</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    formatted_state <span class="op">=</span> torch.tensor(formatted_state)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> formatted_state</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_adj_matrix(edges, num_nodes):</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>        nodes.add(edge[<span class="dv">0</span>])</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>        nodes.add(edge[<span class="dv">1</span>])</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    adj_matrix <span class="op">=</span> np.zeros((num_nodes <span class="op">+</span> <span class="dv">1</span>, num_nodes <span class="op">+</span> <span class="dv">1</span>)) <span class="co"># 0th col and 0th row will just be to pad.</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Populate the adjacency matrix</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>        adj_matrix[edge[<span class="dv">0</span>]][edge[<span class="dv">1</span>]] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adj_matrix</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_max_number(lists_of_tuples):</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    max_number <span class="op">=</span> <span class="bu">float</span>(<span class="st">&#39;-inf&#39;</span>)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> list_of_tuples <span class="kw">in</span> lists_of_tuples:</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tup <span class="kw">in</span> list_of_tuples:</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>            numbers <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> tup <span class="cf">if</span> <span class="bu">isinstance</span>(x, (<span class="bu">int</span>, <span class="bu">float</span>))]</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> numbers:</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>                current_max <span class="op">=</span> <span class="bu">max</span>(numbers)</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> current_max <span class="op">&gt;</span> max_number:</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>                    max_number <span class="op">=</span> current_max</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_number</span></code></pre></div>
</div>
<div id="d6ae81e2-37f2-4a1c-b744-679052a4f931" class="cell code"
data-execution_count="12">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>valid_edges <span class="op">=</span> <span class="bu">set</span>(game.edges)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>game.reset()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;You are the fix player. You go 2nd, because why not.&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Input your numbers in the form of &#39;(num1, num2)&#39;&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="kw">not</span> game.end:</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> format_state(game.get_state())</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    _, _, chosen_edge <span class="op">=</span> cut_ai(state)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    edge <span class="op">=</span> ()</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;AI has chosen to delete&quot;</span>, chosen_edge)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> <span class="bu">input</span>(<span class="st">&quot;Secure next edge mate:&quot;</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> re.match(<span class="vs">r&#39;^\(([1-9]|[1-3][0-9]|4[0-9]),([1-9]|[1-3][0-9]|4[0-9])\)$&#39;</span>, edge):</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>            num1 <span class="op">=</span> <span class="bu">int</span>(edge.replace(<span class="st">&quot;(&quot;</span>, <span class="st">&quot;&quot;</span>).replace(<span class="st">&quot;)&quot;</span>, <span class="st">&quot;&quot;</span>).split(<span class="st">&quot;,&quot;</span>)[<span class="dv">0</span>])</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>            num2 <span class="op">=</span> <span class="bu">int</span>(edge.replace(<span class="st">&quot;(&quot;</span>, <span class="st">&quot;&quot;</span>).replace(<span class="st">&quot;)&quot;</span>, <span class="st">&quot;&quot;</span>).split(<span class="st">&quot;,&quot;</span>)[<span class="dv">1</span>])</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>            tup <span class="op">=</span> (num1, num2)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> tup <span class="kw">in</span> edges:</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                edge <span class="op">=</span> tup</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Wrong format/improper edge. Try again.&quot;</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    game.next_step_player(chosen_edge, user_edge <span class="op">=</span> edge)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>You are the fix player. You go 2nd, because why not.
Input your numbers in the form of &#39;(num1, num2)&#39;
AI has chosen to delete (23, 30)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (1,2)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2     3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19    20    21 
                                       
22    23    24    25    26    27    28 
       X                               
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (19, 20)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (2,3)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                                       
22    23    24    25    26    27    28 
       X                               
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (22, 23)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (3,4)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3  -  4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                                       
22  X 23    24    25    26    27    28 
       X                               
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (19, 26)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (4,5)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3  -  4  -  5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         X             
22  X 23    24    25    26    27    28 
       X                               
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (22, 29)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (5,6)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3  -  4  -  5  -  6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         X             
22  X 23    24    25    26    27    28 
 X     X                               
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (24, 25)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (6,7)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3  -  4  -  5  -  6  -  7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         X             
22  X 23    24  X 25    26    27    28 
 X     X                               
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (25, 26)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (7,14)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3  -  4  -  5  -  6  -  7 
                                     | 
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         X             
22  X 23    24  X 25  X 26    27    28 
 X     X                               
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (25, 32)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (14,21)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3  -  4  -  5  -  6  -  7 
                                     | 
 8     9    10    11    12    13    14 
                                     | 
15    16    17    18    19  X 20    21 
                         X             
22  X 23    24  X 25  X 26    27    28 
 X     X           X                   
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (26, 27)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (21,28)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3  -  4  -  5  -  6  -  7 
                                     | 
 8     9    10    11    12    13    14 
                                     | 
15    16    17    18    19  X 20    21 
                         X           | 
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X                   
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (18, 19)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (28,35)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3  -  4  -  5  -  6  -  7 
                                     | 
 8     9    10    11    12    13    14 
                                     | 
15    16    17    18  X 19  X 20    21 
                         X           | 
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X                 | 
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (17, 24)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (35,42)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3  -  4  -  5  -  6  -  7 
                                     | 
 8     9    10    11    12    13    14 
                                     | 
15    16    17    18  X 19  X 20    21 
             X           X           | 
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X                 | 
29    30    31    32    33    34    35 
                                     | 
36    37    38    39    40    41    42 
                                       
43    44    45    46    47    48    49 
AI has chosen to delete (15, 22)
</code></pre>
</div>
<div class="output stream stdin">
<pre><code>Secure next edge mate: (42,49)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code> 1  -  2  -  3  -  4  -  5  -  6  -  7 
                                     | 
 8     9    10    11    12    13    14 
                                     | 
15    16    17    18  X 19  X 20    21 
 X           X           X           | 
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X                 | 
29    30    31    32    33    34    35 
                                     | 
36    37    38    39    40    41    42 
                                     | 
43    44    45    46    47    48    49 
You won!
</code></pre>
</div>
</div>
<div id="23a30c57-6e93-4784-9ae4-2dcdded361f6" class="cell markdown">
<p>As you can see, the AI, despite it's smart strategy of blocking out
the middle edges of the graph, could not cope with a simple L-strategy,
in which the Fix player merely crawls across the borders to the finish.
It needed more training and more work. It also could've done with
training against certain strategies instead of random selection, but had
the epochs been higher, I'm certain it could've coped with this
strategy. Unfortunately, we didn't have the processing power to train on
more iterations.</p>
<p>Here are these two playing against each other:</p>
</div>
<div id="270ec73b-569b-434b-9072-6886ceb28b1e" class="cell code"
data-execution_count="14">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>num_rows <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>num_cols <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> Graph(num_rows, num_cols)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>game <span class="op">=</span> GameAI(graph)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>edges <span class="op">=</span> game.edges</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>cut_ai <span class="op">=</span> ShannonModel(input_size <span class="op">=</span> <span class="dv">7502</span>, hidden_size <span class="op">=</span> <span class="dv">256</span>, output_size <span class="op">=</span> <span class="dv">84</span>, edges <span class="op">=</span> edges, game <span class="op">=</span> game)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>cut_ai.load_state_dict(torch.load(<span class="st">&quot;Cut/7x7Model.pt&quot;</span>))</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>cut_ai.<span class="bu">eval</span>()</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>fix_ai <span class="op">=</span> ShannonModel(input_size <span class="op">=</span> <span class="dv">7502</span>, hidden_size <span class="op">=</span> <span class="dv">256</span>, output_size <span class="op">=</span> <span class="dv">84</span>, edges <span class="op">=</span> edges, game <span class="op">=</span> game)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>fix_ai.load_state_dict(torch.load(<span class="st">&quot;Fix/7x7Model.pt&quot;</span>))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>fix_ai.<span class="bu">eval</span>()</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>valid_edges <span class="op">=</span> <span class="bu">set</span>(game.edges)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>game.reset()</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="kw">not</span> game.end:</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> format_state(game.get_state())</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    _, _, cut_chosen_edge <span class="op">=</span> cut_ai(state)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    edge <span class="op">=</span> ()</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Cut has chosen to delete&quot;</span>, chosen_edge)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    _, _, fix_chosen_edge <span class="op">=</span> fix_ai(state)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    edge <span class="op">=</span> ()</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    game.next_step_player(chosen_edge <span class="op">=</span> cut_chosen_edge, user_edge <span class="op">=</span> fix_chosen_edge)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Cut has chosen to delete (15, 22)
 1     2     3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19    20    21 
                                       
22    23    24    25    26    27    28 
       X                               
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43  - 44    45    46    47    48    49 
Cut has chosen to delete (15, 22)
 1     2     3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                                       
22    23    24    25    26    27    28 
       X                       |       
29    30    31    32    33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43  - 44    45    46    47    48    49 
Cut has chosen to delete (15, 22)
 1     2     3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                                       
22  X 23    24    25    26    27    28 
       X                       |       
29    30    31    32  - 33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43  - 44    45    46    47    48    49 
Cut has chosen to delete (15, 22)
 1     2     3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         |             
22  X 23    24    25    26    27    28 
       X                       |       
29    30    31    32  - 33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43  - 44    45    46    47    48    49 
Cut has chosen to delete (15, 22)
 1     2     3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         |             
22  X 23    24    25    26    27    28 
 X     X                       |       
29    30    31    32  - 33    34    35 
                                       
36    37    38    39    40    41    42 
                                       
43  - 44    45    46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1     2     3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         |             
22  X 23    24  X 25    26    27    28 
 X     X                       |       
29    30    31    32  - 33  - 34    35 
                                       
36    37    38    39    40    41    42 
                                       
43  - 44    45    46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1     2     3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         |             
22  X 23    24  X 25  X 26    27    28 
 X     X                       |       
29    30    31    32  - 33  - 34    35 
                               |       
36    37    38    39    40    41    42 
                                       
43  - 44    45    46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1     2     3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         |             
22  X 23    24  X 25  X 26    27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
                               |       
36    37    38    39    40    41    42 
                                       
43  - 44    45  - 46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5     6     7 
                                       
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
                               |       
36    37    38    39    40    41    42 
                                       
43  - 44    45  - 46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5     6     7 
       X                               
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
                         |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
                               |       
36    37    38  - 39    40    41    42 
                                       
43  - 44    45  - 46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5     6     7 
       X                               
 8     9    10    11    12    13    14 
                                       
15    16    17    18    19  X 20    21 
             X           |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
                               |       
36    37    38  - 39    40    41  - 42 
                                       
43  - 44    45  - 46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5     6     7 
       X                               
 8     9    10    11    12    13    14 
                                       
15    16  X 17    18    19  X 20    21 
             X           |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
                               |       
36    37    38  - 39    40    41  - 42 
                         |             
43  - 44    45  - 46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5     6     7 
       X                               
 8     9    10    11    12  X 13    14 
                                       
15    16  X 17    18    19  X 20    21 
             X           |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
                   |           |       
36    37    38  - 39    40    41  - 42 
                         |             
43  - 44    45  - 46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5     6     7 
       X                       X       
 8     9    10    11    12  X 13    14 
                                       
15    16  X 17    18    19  X 20    21 
             X           |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
                   |           |       
36    37    38  - 39  - 40    41  - 42 
                         |             
43  - 44    45  - 46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5     6     7 
       X                       X       
 8     9    10    11    12  X 13    14 
                                       
15    16  X 17    18    19  X 20    21 
 X           X           |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
                   |           |       
36    37    38  - 39  - 40    41  - 42 
                         |           | 
43  - 44    45  - 46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
       X                       X       
 8     9    10    11    12  X 13    14 
                                       
15    16  X 17    18    19  X 20    21 
 X           X           |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
 |                 |           |       
36    37    38  - 39  - 40    41  - 42 
                         |           | 
43  - 44    45  - 46    47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
       X                       X       
 8     9    10    11    12  X 13    14 
                                       
15    16  X 17    18  X 19  X 20    21 
 X           X           |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
 |                 |           |       
36    37    38  - 39  - 40    41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
 X     X                       X       
 8     9    10    11    12  X 13    14 
                                       
15    16  X 17    18  X 19  X 20    21 
 X           X           |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
 |                 |           |       
36    37    38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
 X     X                       X       
 8     9    10    11    12  X 13    14 
             |                         
15    16  X 17    18  X 19  X 20    21 
 X           X           |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X           |       
29    30    31    32  - 33  - 34    35 
 |                 |           |       
36    37    38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
 X     X                       X       
 8     9    10    11    12  X 13    14 
             |                 X       
15    16  X 17    18  X 19  X 20    21 
 X           X           |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |           |       
36    37    38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
 X     X                       X       
 8     9    10    11    12  X 13    14 
             |                 X       
15    16  X 17    18  X 19  X 20    21 
 X           X     X     |             
22  X 23    24  X 25  X 26  X 27    28 
 X     X           X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |           |       
36    37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
 X     X                       X       
 8     9    10    11    12  X 13    14 
             |                 X       
15    16  X 17  X 18  X 19  X 20    21 
 X           X     X     |             
22  X 23  - 24  X 25  X 26  X 27    28 
 X     X           X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |           |       
36    37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
 X     X                       X       
 8     9  - 10    11    12  X 13    14 
             |                 X       
15    16  X 17  X 18  X 19  X 20    21 
 X           X     X     |             
22  X 23  - 24  X 25  X 26  X 27    28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |           |       
36    37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
 X     X                       X       
 8     9  - 10    11    12  X 13    14 
             |                 X       
15    16  X 17  X 18  X 19  X 20    21 
 X           X     X     |     X       
22  X 23  - 24  X 25  X 26  X 27    28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36    37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
 X     X                       X       
 8     9  - 10    11    12  X 13    14 
             |                 X       
15    16  X 17  X 18  X 19  X 20    21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27    28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36    37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
 X     X                       X       
 8     9  - 10    11    12  X 13    14 
             |                 X       
15    16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27    28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2     3     4     5  X  6     7 
 X     X                       X       
 8     9  - 10    11    12  X 13    14 
             |                 X     X 
15    16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3     4     5  X  6     7 
 X     X                       X       
 8     9  - 10    11  - 12  X 13    14 
             |                 X     X 
15    16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3     4     5  X  6     7 
 X     X                       X       
 8     9  - 10  - 11  - 12  X 13    14 
             |           X     X     X 
15    16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3     4     5  X  6  -  7 
 X     X                       X       
 8     9  - 10  - 11  - 12  X 13    14 
             |           X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3     4     5  X  6  -  7 
 X     X                 |     X       
 8     9  - 10  - 11  - 12  X 13    14 
             |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3     4     5  X  6  -  7 
 X     X     X           |     X       
 8     9  - 10  - 11  - 12  X 13  - 14 
             |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3     4     5  X  6  -  7 
 X     X     X           |     X     X 
 8     9  - 10  - 11  - 12  X 13  - 14 
       |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3     4  X  5  X  6  -  7 
 X     X     X           |     X     X 
 8     9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |                 |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3     4  X  5  X  6  -  7 
 X     X     X           |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |     |           |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3  -  4  X  5  X  6  -  7 
 X     X     X           |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |     |           |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3  -  4  X  5  X  6  -  7 
 X     X     X     |     |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29    30    31    32  - 33  - 34    35 
 |     |           |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44    45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3  -  4  X  5  X  6  -  7 
 X     X     X     |     |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29  X 30    31    32  - 33  - 34    35 
 |     |           |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44  - 45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3  -  4  X  5  X  6  -  7 
 X     X     X     |     |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29  X 30  X 31    32  - 33  - 34    35 
 |     |     |     |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
                         |           | 
43  - 44  - 45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3  -  4  X  5  X  6  -  7 
 X     X     X     |     |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29  X 30  X 31    32  - 33  - 34    35 
 |     |     |     |     |     |       
36  - 37  - 38  - 39  - 40  - 41  - 42 
       X           |     |           | 
43  - 44  - 45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3  -  4  X  5  X  6  -  7 
 X     X     X     |     |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29  X 30  X 31    32  - 33  - 34    35 
 |     |     |     |     |     |     X 
36  - 37  - 38  - 39  - 40  - 41  - 42 
       X     |     |     |           | 
43  - 44  - 45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3  -  4  X  5  X  6  -  7 
 X     X     X     |     |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29  X 30  X 31  - 32  - 33  - 34    35 
 |     |     |     |     |     |     X 
36  - 37  - 38  - 39  - 40  - 41  - 42 
       X     |     |     |           | 
43  - 44  - 45  - 46  - 47  - 48    49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3  -  4  X  5  X  6  -  7 
 X     X     X     |     |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29  X 30  X 31  - 32  - 33  - 34    35 
 |     |     |     |     |     |     X 
36  - 37  - 38  - 39  - 40  - 41  - 42 
 |     X     |     |     |           | 
43  - 44  - 45  - 46  - 47  - 48  X 49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3  -  4  X  5  X  6  -  7 
 X     X     X     |     |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |       
29  X 30  X 31  - 32  - 33  - 34    35 
 |     |     |     |     |     |     X 
36  - 37  - 38  - 39  - 40  - 41  - 42 
 |     X     |     |     |     |     | 
43  - 44  - 45  - 46  - 47  - 48  X 49 
Cut has chosen to delete (15, 22)
 1  -  2  X  3  -  4  X  5  X  6  -  7 
 X     X     X     |     |     X     X 
 8  X  9  - 10  - 11  - 12  X 13  - 14 
 |     |     |     X     X     X     X 
15  X 16  X 17  X 18  X 19  X 20  X 21 
 X     X     X     X     |     X     | 
22  X 23  - 24  X 25  X 26  X 27  - 28 
 X     X     X     X     |     |     | 
29  X 30  X 31  - 32  - 33  - 34  X 35 
 |     |     |     |     |     |     X 
36  - 37  - 38  - 39  - 40  - 41  - 42 
 |     X     |     |     |     |     | 
43  - 44  - 45  - 46  - 47  - 48  X 49 
You lost mate.
</code></pre>
</div>
</div>
<div id="da35dfc9-a84c-4b40-a8d0-e214a1479436" class="cell markdown">
<p>The Cut player actually did bits, blocking off the middle early, and
the Fix player couldn't cope. It seems like it did a decent job here,
the Cut AI. The Fix AI genuinely could not cope.</p>
</div>
<div id="88b8257d-6f4c-4d1b-9085-637b66e1dec0" class="cell markdown">
<p>This has been a great project and a great class, thank you for your
time. My other work is seen in the other .ipynb notebooks (numbered from
1-4, albeit 2-4 are the most relevant ones). This has been Asad and
Syed, thank you for your time.</p>
</div>
</body>
</html>
